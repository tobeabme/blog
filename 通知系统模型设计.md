几乎每个站点都有消息通知系统，可见消息系统的重要性不言而喻。那么如何设计一个具有

-消息订阅
-消息提醒
-消息推送.方式
    -一对一推送
    -一对多推送

-消息推送.渠道
    -站内
    -站外
        -安卓系统应用
        -IOS系统应用
        -邮箱
        -短信
        -WhatsAPP
        -其它

-消息推送技术
    -websocket
    -第三方SDK开发或接入    

-消息接收.渠道
    -站内
    -站外
        -安卓系统应用
        -IOS系统应用
        -邮箱
        -短信
        -WhatsAPP
        -其它

-消息聚合



通知事件表「notify_event」
记录每一个用户行为产生的消息通知提醒

表结构如下：
```
id: {type: 'integer', primaryKey: true, autoIncrement:true} 
userID: {type: 'string', required: true} //用户ID
action: {type: 'string', required: true} //动作，如：捐款/更新/评论/收藏
objectID: {type: 'string', required: true}, //对象ID；
objectType: {type: 'string', required: true} //对象所属类型，如：人、文章、活动、视频等；
createdAt：{type: 'timestamp', required: true} //创建时间；
```

=-=-=-=-=-=-=-=-=-=-=-=-==-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-==-=-=-=-=-=-=-=

结构体

type NotifySetting struct {
    NotifyActionType []string
    NotifyObjectType []string
    NotifyTemplates []string
    NotifyChannel []string
}

通知行为类型表「notify_action_type」
动作，如：赞了、评论了、喜欢了、捐款了、收藏了；由消息系统内部定义，为后台提供接口，用于通知设置。
表结构如下：

```
notify_object_type := ["donated","conllected","commented","updated"]
```

通知对象类型-数据结构「notify_object_type」
资源对象类型，如：项目、文章、评论、商品、视频、图片、用户；由消息系统内部定义，为后台提供接口，用于通知设置。

```
notify_object_type := ["project","comment"]
```

通知模版「notify_templates」
XXX 喜欢了你的文章 《消息通知系统模型设计》
你喜欢的文章《消息通知系统模型设计》有新的评论

```
notify_templates := ["donated","conllected","updated"]

message.SetString(language.AmericanEnglish, "donated", "XXXXXXXXXXXXXXXXXXXXXXXXXXXXX.")
message.SetString(language.AmericanEnglish, "conllected", "XXXXXXXXXXXXXXXXXXXXXXXXXXXXX.")
message.SetString(language.AmericanEnglish, "updated", "XXXXXXXXXXXXXXXXXXXXXXXXXXXXX.")
```

通知渠道表「notify_channel」
站内，短信，邮件，设备，WhatsAPP

```
notify_channel := ["inside","device","sms","email","whatsapp"]
```

=-=-=-=-=-=-=-=-=-=-=-=-==-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-==-=-=-=-=-=-=-=

通知系统提醒设置表「notify_setting」
为用户在通知设置页面提供屏蔽通知的设置选项，如：
通知提醒
    {我关注的}{项目}有动态{更新}时通知我
    有人{收藏}{我发布的}{项目}时通知我

表结构如下：
```
id: {type: 'integer', primaryKey: true, autoIncrement:true} //通知设置编号；
objectType: {type: 'string', required: true} //资源对象类型，如：项目、文章、评论、商品、视频、图片、用户；
action: {type: 'string', required: true} //动作，也即通知类型，如：捐款、更新、评论、收藏
objectRelationship: {type: 'string', required: true} //用户与资源的关系，如：用户发布的published，用户关注的followed；
notifyTemplate: {type: 'string', required: true} //为某个通知类型设置对应的通知模版
notify_channel: {type: 'string', required: true} //为某个通知类型设置一个或多个推送渠道
description: {type: 'string', required: true}  //设置选项的内容描述
settingType: {type: 'string', required: true} //remind、privateLetters
```

=-=-=-=-=-=-=-=-=-=-=-=-==-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-==-=-=-=-=-=-=-=

通知用户提醒设置表「notify_setting_user」
当无用户的任何记录时，即用户没有设置时，默认代表用户是开启了接收此类通知的；否则如果有用户的设置记录，则代表用户关闭了此类通知的接收；

表结构如下：
```
id: {type: 'integer', primaryKey: true, autoIncrement:true} //用户通知设置ID；
userId: {type: 'string', required: true}，//用户ID，对应 notify_remind 中的 recipientId；
settingId: {type: 'string', required: true}，//通知设置表ID
createdAt：{type: 'timestamp', required: true} //创建时间；
```

=-=-=-=-=-=-=-=-=-=-=-=-==-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-==-=-=-=-=-=-=-=


提醒表「notify_remind」
所有用户的通知消息记录将存放在这里

表结构如下：
```
id: {type: 'integer', primaryKey: true, autoIncrement:true} //主键；
remindID: {type: 'string', required: true} //通知提醒编号；
senderID: {type: 'string', required: true} //操作者的ID，三个0代表是系统发送的；
senderName: {type: 'string’, required: true} //操作者用户名；
senderAction: {type: 'string', required: true} //操作者的动作，如：捐款、更新、评论、收藏；
objectID: {type: 'string', required: true}, //目标对象ID；
object: {type: 'string', required: false}, //目标对象内容或简介，比如：文章标题；
objectType: {type: 'string', required: true} //被操作对象类型，如：人、文章、活动、视频等；
recipientID: {type: 'string’} //消息接收者；可能是对象的所有者或订阅者；
message: {type: 'text', required: true} //消息内容，由提醒模版生成，需要提前定义；
createdAt：{type: 'timestamp', required: true} //创建时间；
status：{type: 'integer', required: false} //是否阅读，默认未读；
readAt:{type: 'timestamp', required: false} //阅读时间；
```